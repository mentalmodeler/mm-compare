(this["webpackJsonpmm-compare"]=this["webpackJsonpmm-compare"]||[]).push([[0],[,,,,,,,,,,function(e){e.exports=JSON.parse('{"modelsJSON":[{"info":{"name":"Model","author":"","description":"","version":"1.1","date":"Mon Jan 09 2017 19:35:21 GMT-0600 (Central Standard Time)"},"groupNames":{},"concepts":[{"id":"2","name":"Amount of Wetland","notes":"","units":"","group":"0","x":"87","y":"28","preferredState":"0","relationships":[{"id":"3","name":"Fish population","notes":"","confidence":"0","influence":"1"},{"id":"4","name":"Pollution","notes":"","confidence":"0","influence":"-0.1"},{"id":"5","name":"Livelihood","notes":"","confidence":"0","influence":"0.8"},{"id":"6","name":"Laws","notes":"","confidence":"0","influence":"0"}]},{"id":"3","name":"Fish population","notes":"","units":"","group":"0","x":"309","y":"303","preferredState":"0","relationships":[{"id":"5","name":"Livelihood","notes":"","confidence":"0","influence":"1"}]},{"id":"4","name":"Pollution","notes":"","units":"","group":"0","x":"132","y":"239","preferredState":"0","relationships":[{"id":"2","name":"Amount of Wetland","notes":"","confidence":"0","influence":"-0.2"},{"id":"3","name":"Fish population","notes":"","confidence":"0","influence":"-1"},{"id":"5","name":"Livelihood","notes":"","confidence":"0","influence":"-0.2"}]},{"id":"5","name":"Livelihood","notes":"","units":"","group":"0","x":"531","y":"234","preferredState":"0","relationships":[]},{"id":"6","name":"Laws","notes":"","units":"","group":"0","x":"503","y":"32","preferredState":"0","relationships":[{"id":"2","name":"Amount of Wetland","notes":"","confidence":"0","influence":"0.2"},{"id":"3","name":"Fish population","notes":"","confidence":"0","influence":"0.5"},{"id":"4","name":"Pollution","notes":"","confidence":"0","influence":"-0.5"},{"id":"5","name":"Livelihood","notes":"","confidence":"0","influence":"-0.2"}]}],"scenarios":[{"name":"Scenario","concepts":[]}],"id":"id-1c67f325a955b"},{"info":{"name":"FCM","author":"arousset","description":"","version":"1.0","date":"Wed Feb 5 16:42:59 GMT-0600 2014","id":"6ecbe43a-94e0-4b8e-84e4-66caa3764420"},"groupNames":{"0":"dfghfdgh","1":"ertyretyrte","2":"xcvbcbvxcvb","3":"","4":"","5":""},"concepts":[{"id":"1","name":"Fish population","notes":"","units":"","group":"0","x":"604","y":"200","relationships":[{"id":"7","name":"Livelihood","notes":"","confidence":"0","influence":"1"}]},{"id":"2","name":"Amount of wetland","notes":"","units":"","group":"1","x":"200","y":"205","relationships":[{"id":"1","name":"Fish population","notes":"","confidence":"0","influence":"1"},{"id":"8","name":"Pollution","notes":"","confidence":"0","influence":"-0.25"},{"id":"7","name":"Livelihood","notes":"","confidence":"0","influence":"0.62"}]},{"id":"6","name":"Enforcement of laws","notes":"","units":"","group":"2","x":"395","y":"44","relationships":[{"id":"2","name":"Amount of wetland","notes":"","confidence":"0","influence":"0.25"},{"id":"1","name":"Fish population","notes":"","confidence":"0","influence":"0.62"},{"id":"8","name":"Pollution","notes":"","confidence":"0","influence":"-0.62"},{"id":"7","name":"Livelihood","notes":"","confidence":"0","influence":"-0.25"}]},{"id":"7","name":"Livelihood","notes":"","units":"","group":"0","x":"682","y":"458","relationships":[]},{"id":"8","name":"Pollution","notes":"","units":"","group":"0","x":"281","y":"467","relationships":[{"id":"2","name":"Amount of wetland","notes":"","confidence":"0","influence":"-0.25"},{"id":"1","name":"Fish population","notes":"","confidence":"0","influence":"-1"},{"id":"7","name":"Livelihood","notes":"","confidence":"0","influence":"-0.25"}]}],"scenarios":[{"name":"A lot of fish die","concepts":[{"selected":"true","influence":"-1","id":"1","name":"Fish population"},{"selected":"true","influence":"","id":"2","name":"Amount of wetland"},{"selected":"true","influence":"","id":"6","name":"Enforcement of laws"},{"selected":"true","influence":"","id":"7","name":"Livelihood"},{"selected":"true","influence":"","id":"8","name":"Pollution"}]}],"id":"id-63492cf0806b2"}],"results":{},"canonicalId":"id-1c67f325a955b","viewResultId":null,"mode":"files"}')},,,,,,,,function(e,n,t){},,function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){"use strict";t.r(n);var c=t(0),i=t(2),a=t.n(i),o=t(9),r=t.n(o),s=(t(18),t(1)),l=t(11),d=t(8),u=t.n(d),m=t(3),f=t.n(m),j=t(4),p=function(e){var n=new FileReader;return new Promise((function(t,c){n.onerror=function(){n.abort(),c(new DOMException("MMP file loading failed!"))},n.onload=function(){t(n.result)},n.readAsText(e)}))},h=["relationships","concepts","properties"],b=function(e){try{return e.indexOf("<?xml")>-1?O(e):JSON.parse(e)}catch(n){console.error(n),alert("Parsing of mmp failed!")}},O=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t={},c=new DOMParser,i=c.parseFromString(e,"application/xml"),a=i.firstChild.childNodes;return a.forEach((function(e){switch(e.localName){case"info":-1===n.indexOf("info")&&(t.info=v(e));break;case"groupNames":-1===n.indexOf("group")&&(t.groupNames=v(e,!0));break;case"concepts":-1===n.indexOf("concepts")&&(t.concepts=x(_(e)));break;case"scenarios":-1===n.indexOf("scenario")&&(t.scenarios=x(_(e)))}})),t},v=function(e,n){var t={};return e.childNodes.forEach((function(e){if(1===e.nodeType){if("groupName"===e.localName){var c=e.getAttribute("index");t[c]=e.textContent}h.indexOf(e.localName)>-1?t[e.localName]=x(_(e)):n||(t[e.localName]=e.textContent)}})),t},x=function(e){var n=[];return e.forEach((function(e){n.push(v(e))})),n},_=function(e){var n=[];return e.childNodes.forEach((function(e){1===e.nodeType&&n.push(e)})),n};function N(e){return g.apply(this,arguments)}function g(){return(g=Object(j.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=b,e.next=3,p(n);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=function(e,n){return Object(s.a)(Object(s.a)({},"number"===typeof e&&{marginTop:"".concat(e,"px")}),"number"===typeof n&&{marginBottom:"".concat(n,"px")})},y=function(e){return e.target.dataset.id},w=function(e,n){var t=n.find((function(n){return e===n.id}))||{};return Object(s.a)({},t)},C=function(e){var n=e.concepts,t=void 0===n?[]:n;e.scenarios;return{concepts:t.map((function(e){return{name:e.name,id:e.id,selected:!0,influence:0,expectedChange:0,preferredState:e.preferredState,points:0}}))}};t(20);var k=function(){var e=Object(i.useRef)(null),n=(Object(i.useRef)(""),Object(i.useContext)(T)),t=n.state,a=n.setState,o=n.dispatch;return Object(c.jsxs)("div",{className:"controls",children:[!1,Object(c.jsxs)("div",{className:"controls__load-local",children:[Object(c.jsx)("input",{type:"button",onClick:function(){return e.current.click()},value:"Load",className:"btn btn-ghost"}),Object(c.jsx)("input",{type:"file",multiple:!0,ref:e,style:{display:"none"},onChange:function(e){var n=e.target.files;return n&&n.length>0&&Array.from(n).forEach(function(){var e=Object(j.a)(f.a.mark((function e(n){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(n);case 2:t=e.sent,o({action:{type:"addJSON",json:t}});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())},value:""})]}),Object(c.jsx)("input",{type:"button",onClick:function(){return a({mode:"scenario"})},value:"Configure scenario",className:"btn btn-ghost",disabled:!t.canonicalId}),Object(c.jsx)("input",{type:"button",onClick:function(){return a({action:{type:"compare"}})},value:"Compare",className:"btn btn-ghost",disabled:!t.canonicalId||t.modelsJSON.length<2})]})};t(21);var I=function(){var e=Object(i.useContext)(T),n=e.state,t=e.setState,a=e.dispatch,o=n.modelsJSON,r=n.canonicalId,s=n.results,l=void 0===s?{}:s;return Object(c.jsx)("div",{className:"models",children:o.map((function(e,n){var i=e||{info:{}},o=i.info,s=i.id,d=o.author,m=o.date,f=o.name,j=l[s];return Object(c.jsx)("div",{className:"model-wrapper",children:Object(c.jsxs)("div",{className:"model",children:[Object(c.jsxs)("div",{className:"model__info",children:[Object(c.jsx)("div",{className:"model__author",children:d||"[Author]"}),Object(c.jsx)("div",{className:"model__name",children:f||"[Name]"}),Object(c.jsx)("div",{className:"model__date",children:m?new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}).format(new Date(m)):"[Date]"})]}),j&&Object(c.jsxs)("div",{className:"model__score",children:[Object(c.jsx)("div",{className:"model__score-value",children:"Score: ".concat(j.score)}),Object(c.jsx)("div",{className:"model__score-result",children:Object(c.jsx)("button",{className:"link-btn",onClick:function(){return t({mode:"result",viewResultId:s})},children:"View result"})})]}),Object(c.jsxs)("div",{className:"model__controls",children:[Object(c.jsx)("button",{className:u()("canonical-btn",{"canonical-btn--selected":s===r}),onClick:function(){return t({canonicalId:s})},children:Object(c.jsx)("span",{children:"Reference"})}),Object(c.jsx)("button",{className:"link-btn",onClick:function(){return a({action:{type:"removeModel",id:s}})},children:"Remove"})]})]})},"model-".concat(n))}))})};t(22);var M=function(e){var n=e.children,t=e.className,a=void 0===t?"":t,o=Object(i.useContext)(T),r=(o.state,o.setState);return Object(c.jsxs)("div",{className:"Overlay ".concat(a),children:[Object(c.jsx)("button",{className:"Overlay__close btn btn-ghost",onClick:function(){return r({mode:"files"})},children:Object(c.jsx)("span",{children:"Close"})}),Object(c.jsx)("div",{className:"Overlay__bg"}),Object(c.jsx)("div",{className:"Overlay__body",children:Object(c.jsx)("div",{className:"Overlay__content",children:n})})]})},J=(t(23),function(e){var n=e.name;return Object(c.jsx)("div",{className:"result__concept",children:n})}),L=function(e){var n=e.fromNode,t=e.toNode,i=e.relationship,a="affects";return"0"!==i.influence&&(a=i.influence>0?"increases":"decreases"),Object(c.jsxs)("div",{className:"result__linkage",children:[n.name||"[Missing fromNode]",Object(c.jsxs)("div",{className:"result__linkage-sign",children:[Object(c.jsx)("svg",{focusable:"false","data-id":"SVG_ARROW_RIGHT__24",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:Object(c.jsx)("g",{fill:"none",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",children:Object(c.jsx)("line",{x1:"4",y1:"12",x2:"20",y2:"12",stroke:"#fff"})})}),Object(c.jsx)("span",{children:a}),Object(c.jsx)("svg",{focusable:"false","data-id":"SVG_ARROW_RIGHT__24",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:Object(c.jsx)("g",{fill:"none",stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",children:Object(c.jsx)("path",{d:"M15.7 7l5 5-5 5M20.8 12H3.2"})})})]}),t.name||"[Missing toNode]"]})},E=function(e,n,t){return n.length>0?Object(c.jsxs)(i.Fragment,{children:[Object(c.jsx)("span",{children:e}),Object(c.jsx)("span",{className:"results__points-line-item",children:"".concat(t).concat(n.length," point").concat(n.length>1?"s":"")})]}):e};var F=function(){var e=Object(i.useContext)(T),n=e.state,t=(e.setState,n.results),a=n.modelsJSON,o=n.viewResultId,r=a.find((function(e){return e.id===o})),l=t[o],d=l.score,u=l.nodes,m=l.relationships,f=u.extra,j=u.missing,p=u.present,h=m.extra,b=m.missing,O=m.incorrectlySigned,v=m.correctlySigned,x=(r||{info:{}}).info,_=x.author,N=x.date,g=x.name,y=[{title:E("Missing (".concat(b.length,")"),b,"-"),collection:b},{title:E("Extra (".concat(h.length,")"),h,"-"),collection:h},{title:"Incorrectly signed (".concat(O.length,")"),collection:O},{title:E("Correctly signed (".concat(v.length,")"),v,"+"),collection:v}],w=[{title:"Missing (".concat(j.length,")"),collection:j},{title:"Extra (".concat(f.length,")"),collection:f},{title:"Present (".concat(p.length,")"),collection:p}];return Object(c.jsxs)(M,{children:[Object(c.jsx)("div",{style:S(null,12),className:"result__author weight-300 h3 capitalize",children:_||"[Author]"}),Object(c.jsx)("div",{className:"result__name weight-500 capitalize",children:g||"[Name]"}),Object(c.jsx)("div",{style:S(null,12),className:"result__date italic",children:N?new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}).format(new Date(N)):"[Date]"}),Object(c.jsx)("div",{style:S(null,32),className:"font-blue h2 italic weight-300",children:"SCORE: ".concat(d)}),Object(c.jsx)("div",{className:"result__category uppercase weight-600 font-blue h3",children:"LINKAGES"}),y.map((function(e,n){var t=e.title,a=e.collection;return Object(c.jsxs)(i.Fragment,{children:[Object(c.jsx)("div",{className:"result__group-title weight-300",children:t}),Object(c.jsx)("div",{className:"result__linkages",children:a.map((function(e,n){return Object(i.createElement)(L,Object(s.a)(Object(s.a)({},e),{},{key:"linkage-".concat(n)}))}))})]},"collection-".concat(n))})),Object(c.jsx)("div",{className:"result__category uppercase weight-600 font-blue h3",children:"Concepts"}),w.map((function(e,n){var t=e.title,a=e.collection;return Object(c.jsxs)(i.Fragment,{children:[Object(c.jsx)("div",{className:"result__group-title weight-300",children:t}),Object(c.jsx)("div",{className:"result__concepts",children:a.map((function(e,n){var t=e.name;e.id;return Object(c.jsx)(J,{name:t},"linkage-".concat(n))}))})]},"collection-".concat(n))}))]})};t(24);var R=function(){var e=Object(i.useContext)(T),n=e.state,t=e.dispatch,a=n.scenario,o=(a||{concepts:[]}).concepts,r=function(e,n){return t({action:{type:"updateScenario",id:e,concept:n}})},l=function(e){var n=y(e);r(n,Object(s.a)(Object(s.a)({},w(n,o)),{},{selected:e.target.checked}))},d=function(e){var n=y(e);r(n,Object(s.a)(Object(s.a)({},w(n,o)),{},{influence:e.target.value}))},u=function(e){var n=y(e);r(n,Object(s.a)(Object(s.a)({},w(n,o)),{},{expectedChange:e.target.value}))};return Object(c.jsxs)(M,{children:[Object(c.jsx)("div",{className:"Scenario__title h2 weight-300",children:"Scenario"}),Object(c.jsxs)("div",{className:"Scenario__rows",children:[Object(c.jsxs)("div",{className:"Scenario__row Scenario__row--header",children:[Object(c.jsx)("div",{className:"Scenario__col Scenario__col--include"}),Object(c.jsx)("div",{className:"Scenario__col Scenario__col--component",children:"Concept"}),Object(c.jsx)("div",{className:"Scenario__col Scenario__col--adjust",children:"+ / \u2013"}),Object(c.jsx)("div",{className:"Scenario__col Scenario__col--expected-change",children:"Expected change"}),Object(c.jsx)("div",{className:"Scenario__col Scenario__col--points",children:"Points"})]}),a.concepts.map((function(e,n){var t=e.name,i=e.id,a=e.selected,o=e.influence,r=e.expectedChange,s=e.points,m=0!==parseInt(r,10),f=0!==parseInt(o,10),j=f||!a;return Object(c.jsxs)("div",{className:"Scenario__row".concat(j?" Scenario__row--disabled-text":""),children:[Object(c.jsx)("div",{className:"Scenario__col Scenario__col--include no-padding",children:!f&&Object(c.jsx)("label",{className:"Scenario__include-label",children:Object(c.jsx)("input",{type:"checkbox",id:"scenario-selected-".concat(i),"data-id":i,checked:a,onChange:l})})}),Object(c.jsx)("div",{className:"Scenario__col Scenario__col--component",children:t}),Object(c.jsx)("div",{className:"Scenario__col Scenario__col--adjust no-padding",children:a&&!m&&Object(c.jsxs)("select",{value:o,className:"Scenario__select",id:"scenario-adjust-".concat(i),"data-id":i,onChange:d,children:[Object(c.jsx)("option",{value:"1",children:"+"}),Object(c.jsx)("option",{value:"0",children:""}),Object(c.jsx)("option",{value:"-1",children:"\u2013"})]})}),Object(c.jsx)("div",{className:"Scenario__col Scenario__col--expected-change no-padding",children:a&&!f&&Object(c.jsxs)("select",{value:r,className:"Scenario__select",id:"scenario-expect-change-".concat(i),"data-id":i,onChange:u,children:[Object(c.jsx)("option",{value:"1",children:"Increase"}),Object(c.jsx)("option",{value:"0",children:""}),Object(c.jsx)("option",{value:"-1",children:"Decrease"})]})}),Object(c.jsx)("div",{className:"Scenario__col Scenario__col--points",children:a&&!f&&Object(c.jsx)("input",{type:"text",className:"Scenario__input-points input",placeholder:m?"Enter points":"",id:"scenario-points-".concat(i),"data-id":i,value:m?s:"",disabled:!m})})]},"scenario-row-".concat(n))}))]})]})},A=t(12),P=function(e,n){var t=n.action,c=Object(s.a)(Object(s.a)({},e),n);if(delete c.action,t&&t.type)if("addJSON"===t.type)c=Object(s.a)(Object(s.a)({},c),{},{modelsJSON:[].concat(Object(A.a)(c.modelsJSON),[Object(s.a)(Object(s.a)({},t.json),!t.json.id&&{id:"id-".concat(Math.random().toString(16).slice(2))})])});else if("removeModel"===t.type)c=Object(s.a)(Object(s.a)({},c),{},{modelsJSON:c.modelsJSON.filter((function(e){return e.id!==t.id}))},c.canonicalId===t.id&&{canonicalId:null});else if("compare"===t.type){var i=function(e){var n=e.modelsJSON,t=e.canonicalId,c=n.find((function(e){return e.id===t})),i=n.filter((function(e){return e.id!==t})),a={};return i.forEach((function(e){a[e.id]=function(e,n){var t,c=function(e){return e.toLowerCase().trim()},i=function(e){return{name:e.name,id:e.id}},a=function(e){var n=e.id,t=e.nodes.find((function(e){return e.id===n}))||{id:"",name:"[not found]"};return i(t)},o=function(e,n,t){var c=e.name,i=e.id,o=e.relationships;return o&&o.map((function(e){var n=e.name,o=e.id,r=e.influence;return{fromNode:{id:i,name:c},toNode:a({id:o,nodes:t}),relationship:{id:o,name:n,influence:r,fromNodeId:i}}}))},r=function(e,n){var t=n.map((function(e){var n=e.name;return c(n)}));return e.filter((function(e){var n=e.name;return!t.includes(c(n))}))},s=function(e,n){var t=n.map((function(e){var n=e.fromNode,t=e.toNode;return c(n.name+t.name)}));return e.filter((function(e){var n=e.fromNode,i=e.toNode;return!t.includes(c(n.name+i.name))}))},l=n.concepts.map(i),d=e.concepts.map(i),u=n.concepts.flatMap(o),m=e.concepts.flatMap(o),f=r(d,l),j=r(l,d),p=function(e,n){var t=n.map((function(e){var n=e.name;return c(n)}));return e.filter((function(e){var n=e.name;return t.includes(c(n))}))}(d,l),h=s(m,u),b=s(u,m),O=function(e,n){var t=n.map((function(e){var n=e.fromNode,t=e.toNode;return c(n.name+t.name)}));return e.filter((function(e){var n=e.fromNode,i=e.toNode;return t.includes(c(n.name+i.name))}))}(m,u),v=(t=u,O.filter((function(e){var n=e.fromNode,i=e.relationship,a=c(n.name+i.name);return t.find((function(e){var n,t,o=e.fromNode,r=e.relationship;return a===c(o.name+i.name)&&(n=i.influence,t=r.influence,n>0&&t>0||n<0&&t<0||0===n&&0===t)}))}))),x=s(O,v),_=v.length-(h.length+b.length);return{id:e.id,score:_,nodes:{extra:f,missing:j,present:p},relationships:{extra:h,missing:b,correctlySigned:v,incorrectlySigned:x}}}(e,c)})),a}({modelsJSON:c.modelsJSON,canonicalId:c.canonicalId});c=Object(s.a)(Object(s.a)({},c),{},{results:i})}else if("updateScenario"===t.type){var a=t.id,o=t.concept;c=Object(s.a)(Object(s.a)({},c),{},{scenario:Object(s.a)(Object(s.a)({},c.scenario.map),{},{concepts:c.scenario.concepts.map((function(e){return a===e.id?o:e}))})})}if(n.hasOwnProperty("canonicalId")&&c.canonicalId!==e.canonicalId){var r=c.modelsJSON.find((function(e){return e.id===c.canonicalId}));c=Object(s.a)(Object(s.a)({},c),{},{scenario:C(r||{concepts:[]})})}return c},T=(t(10),t(25),a.a.createContext({modelsJSON:[],results:{},canonical:null,mode:"scenario"}));var D=function(){var e=Object(i.useReducer)(P,{modelsJSON:[],results:{},canonicalId:null,viewResultId:null,mode:"files"}),n=Object(l.a)(e,2),t=n[0],a=n[1],o=t.mode;return t.results,t.modelsJSON,t.showInternalTools,Object(i.useEffect)((function(){}),[]),Object(c.jsx)(T.Provider,{value:{state:t,setState:a,dispatch:a},children:Object(c.jsxs)("div",{className:"MMCompare",children:[Object(c.jsx)("header",{className:"header",children:Object(c.jsxs)("div",{className:"header__primary",children:[Object(c.jsx)("div",{className:"logo",children:Object(c.jsxs)("div",{className:"logo-inner",children:[Object(c.jsx)("span",{children:"MentalModeler"}),Object(c.jsx)("span",{children:"COMPARE"})]})}),Object(c.jsx)(k,{})]})}),Object(c.jsxs)("main",{className:"main",children:[Object(c.jsx)(I,{}),"result"===o&&Object(c.jsx)(F,{}),"scenario"===o&&Object(c.jsx)(R,{})]})]})})};r.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(D,{})}),document.getElementById("root"))}],[[26,1,2]]]);
//# sourceMappingURL=main.8a6efe64.chunk.js.map