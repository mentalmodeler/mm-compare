(this["webpackJsonpmm-compare"]=this["webpackJsonpmm-compare"]||[]).push([[0],{17:function(e,n,t){},19:function(e,n,t){},20:function(e,n,t){},21:function(e,n,t){},22:function(e,n,t){},23:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t(1),c=t.n(a),o=t(9),s=t.n(o),i=(t(17),t(10)),l=t(2),u=t(11),d=t(6),m=t.n(d);var f=function(){var e=Object(a.useContext)(R),n=e.state,t=e.dispatch,c=n.modelsJSON,o=n.canonicalId,s=function(e,n){var t,r=e.info,a=r.author,c=r.modelName,o=function(e){return e.toLowerCase().trim()},s=function(e){return{name:e.name,id:e.id}},i=function(e){var n=e.name,t=e.id,r=e.relationships;return r&&r.map((function(e){var r=e.name,a=e.id,c=e.influence;return{fromNode:{id:t,name:n},toNode:{id:a,name:r},relationship:{id:a,name:r,influence:c,fromNodeId:t}}}))},l=function(e,n){var t=n.map((function(e){var n=e.name;return o(n)}));return e.filter((function(e){var n=e.name;return!t.includes(o(n))}))},u=function(e,n){var t=n.map((function(e){var n=e.fromNode,t=e.toNode;return o(n.name+t.name)}));return e.filter((function(e){var n=e.fromNode,r=e.toNode;return!t.includes(o(n.name+r.name))}))},d=n.concepts.map(s),m=e.concepts.map(s),f=n.concepts.flatMap(i),p=e.concepts.flatMap(i),j=l(m,d),h=l(d,m),b=function(e,n){var t=n.map((function(e){var n=e.name;return o(n)}));return e.filter((function(e){var n=e.name;return t.includes(o(n))}))}(m,d),O=u(p,f),v=u(f,p),x=function(e,n){var t=n.map((function(e){var n=e.fromNode,t=e.toNode;return o(n.name+t.name)}));return e.filter((function(e){var n=e.fromNode,r=e.toNode;return t.includes(o(n.name+r.name))}))}(p,f),N=(t=f,x.filter((function(e){var n=e.fromNode,r=e.relationship,a=o(n.name+r.name);return t.find((function(e){var n,t,c=e.fromNode,s=e.relationship;return a===o(c.name+r.name)&&(n=r.influence,t=s.influence,n>0&&t>0||n<0&&t<0||0===n&&0===t)}))}))),y=u(x,N);return{author:a||"[Author]",name:c||"[Name]",score:N.length-(O.length+v.length),nodes:{extra:j,missing:h,present:b},relationships:{extra:O,missing:v,correctlySigned:N,incorrectlySigned:y}}};return Object(r.jsx)("input",{type:"button",className:"btn btn-ghost",onClick:function(){var e=c.find((function(e){return e.id===o})),n=c.filter((function(e){return e.id!==o})),r=[];n.forEach((function(n){return r.push(s(n,e))})),t({action:{type:"addResults",results:r}})},value:"Run comparison"})},p=t(3),j=t.n(p),h=t(4);t(19);function b(e){var n=new FileReader;return new Promise((function(t,r){n.onerror=function(){n.abort(),r(new DOMException("MMP file loading failed!"))},n.onload=function(){t(n.result)},n.readAsText(e)}))}function O(e){var n=new XMLHttpRequest;return n.open("GET",e,!0),n.responseType="text",new Promise((function(e,t){n.onerror=function(){n.abort(),t(new DOMException("MMP url loading failed!"))},n.onload=function(){e(n.result)},n.send()}))}var v=["relationships","concepts","properties"];function x(e){try{return e.indexOf("<?xml")>-1?function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t={};return(new DOMParser).parseFromString(e,"application/xml").firstChild.childNodes.forEach((function(e){switch(e.localName){case"info":-1===n.indexOf("info")&&(t.info=N(e));break;case"groupNames":-1===n.indexOf("group")&&(t.groupNames=N(e,!0));break;case"concepts":-1===n.indexOf("concepts")&&(t.concepts=y(_(e)));break;case"scenarios":-1===n.indexOf("scenario")&&(t.scenarios=y(_(e)))}})),t}(e):JSON.parse(e)}catch(n){console.error(n),alert("Parsing of mmp failed!")}}function N(e,n){var t={};return e.childNodes.forEach((function(e){if(1===e.nodeType){if("groupName"===e.localName){var r=e.getAttribute("index");t[r]=e.textContent}v.indexOf(e.localName)>-1?t[e.localName]=y(_(e)):n||(t[e.localName]=e.textContent)}})),t}function y(e){var n=[];return e.forEach((function(e){n.push(N(e))})),n}function _(e){var n=[];return e.childNodes.forEach((function(e){1===e.nodeType&&n.push(e)})),n}function g(e){return w.apply(this,arguments)}function w(){return(w=Object(h.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=x,e.next=3,b(n);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return S.apply(this,arguments)}function S(){return(S=Object(h.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=x,e.next=3,O(n);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=function(){var e=Object(a.useRef)(null),n=Object(a.useRef)(""),t=Object(a.useContext)(R).dispatch,c=function(){var e=Object(h.a)(j.a.mark((function e(){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(n.current.value);case 2:r=e.sent,t({action:{type:"addJSON",json:r}});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:"controls",children:[Object(r.jsxs)("div",{className:"controls__load-local",children:[Object(r.jsx)("input",{type:"button",onClick:function(){return e.current.click()},value:"Load from Local",className:"btn btn-ghost"}),Object(r.jsx)("input",{type:"file",multiple:!0,ref:e,style:{display:"none"},onChange:function(e){var n=e.target.files;n&&n.length>0&&Array.from(n).forEach(function(){var e=Object(h.a)(j.a.mark((function e(n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(n);case 2:r=e.sent,t({action:{type:"addJSON",json:r}});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())},value:""})]}),Object(r.jsxs)("div",{className:"controls__load-url",children:[Object(r.jsx)("input",{type:"text",ref:n,className:"input",placeholder:"Enter URL here"}),Object(r.jsx)("input",{type:"button",onClick:c,value:"Load from URL",className:"btn btn-ghost"})]})]})};t(20);var k=function(){var e=Object(a.useContext)(R),n=e.state,t=e.setState,c=e.dispatch,o=n.modelsJSON,s=n.canonicalId;return Object(r.jsx)("div",{className:"models",children:o.map((function(e,n){var a=e||{info:{}},o=a.info,i=a.id,l=o.author,u=o.date,d=o.name;return Object(r.jsx)("div",{className:"model-wrapper",children:Object(r.jsxs)("div",{className:"model",children:[Object(r.jsxs)("div",{className:"model__info",children:[Object(r.jsx)("div",{className:"model__author",children:l||"[Author]"}),Object(r.jsx)("div",{className:"model__name",children:d||"[Name]"}),Object(r.jsx)("div",{className:"model__date",children:u?new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}).format(new Date(u)):"[Date]"})]}),Object(r.jsxs)("div",{className:"model__controls",children:[Object(r.jsx)("button",{className:m()("canonical-btn",{"canonical-btn--selected":i===s}),onClick:function(){return t({canonicalId:i})},children:Object(r.jsx)("span",{children:"Canonical"})}),Object(r.jsx)("button",{className:"delete-btn",onClick:function(){return c({action:{type:"removeModel",id:i}})},children:"Remove"})]})]})},"model-".concat(n))}))})};t(21);var J=function(){return Object(a.useContext)(R).state.results,Object(r.jsx)("div",{className:"results",children:Object(r.jsx)("h1",{children:"Results"})})},R=(t(22),c.a.createContext({modelsJSON:[],results:{},canonical:null}));var E=function(){var e=Object(a.useReducer)((function(e,n){var t=Object(l.a)(Object(l.a)({},e),n),r=n.action;return r&&r.type&&("addJSON"===r.type?t=Object(l.a)(Object(l.a)({},t),{},{modelsJSON:[].concat(Object(i.a)(t.modelsJSON),[Object(l.a)(Object(l.a)({},r.json),!r.json.id&&{id:"id-".concat(Math.random().toString(16).slice(2))})])}):"removeModel"===r.type?t=Object(l.a)(Object(l.a)({},t),{},{modelsJSON:t.modelsJSON.filter((function(e){return e.id!==r.id}))},t.canonical===r.id&&{canonicalId:null}):"addResults"===r.type&&(t=Object(l.a)(Object(l.a)({},t),{},{results:r.results}))),t}),{modelsJSON:[],results:{},canonicalId:null,mode:"files"}),n=Object(u.a)(e,2),t=n[0],c=n[1],o=t.mode;return Object(r.jsx)(R.Provider,{value:{state:t,setState:c,dispatch:c},children:Object(r.jsxs)("div",{className:"MMCompare",children:[Object(r.jsxs)("header",{className:"header",children:[Object(r.jsxs)("div",{className:"header__primary",children:[Object(r.jsxs)("div",{className:"logo",children:[Object(r.jsx)("span",{children:"MentalModeler"}),Object(r.jsx)("span",{children:"COMPARE"})]}),Object(r.jsxs)("div",{className:"header__mode-select",children:[Object(r.jsx)("div",{className:m()("header__mode-select-mode",{"header__mode-select-mode--selected":"files"===o}),onClick:function(){return c({mode:"files"})},children:Object(r.jsx)("span",{children:"Files"})}),Object(r.jsx)("div",{className:m()("header__mode-select-mode",{"header__mode-select-mode--selected":"compare"===o}),onClick:function(){return c({mode:"compare"})},children:Object(r.jsx)("span",{children:"Compare"})})]})]}),Object(r.jsxs)("div",{className:"header__secondary",children:["files"===o&&Object(r.jsx)(M,{}),"compare"===o&&Object(r.jsx)(f,{})]})]}),Object(r.jsxs)("main",{className:"main",children:["files"===o&&Object(r.jsx)(k,{}),"compare"===o&&Object(r.jsx)(J,{})]})]})})};s.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(E,{})}),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.a189b2d3.chunk.js.map